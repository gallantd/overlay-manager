"use strict";var OverlayManager=function(a,b,c){var d=!b||!a||"object"!=typeof a;return this.adfree=c||!1,this.$window=$(window),this.$body=$("body"),d?(this.errorLog("Current URL | Data object has not been provided"),!1):(this.defaults={zones:null,cookieTime:1,cookieValue:"true",cookieName:"LiveEvent",width:"100%",height:"100%",backgroundColor:"0,0,0",opacity:"0.8",onAdfree:!1},this.defaults.currentUrl=b,void this.setDefaults(a))};OverlayManager.prototype.OVERLAY_ID="OverlayModal",OverlayManager.prototype.FRAME_ID="OverlayFrame",OverlayManager.prototype.setDefaults=function(a){return a[0]&&a[0].promos?(this.options=$.extend(this.options,this.defaults,a),void(this.options&&this.overlayCheck())):(this.errorLog("data zones not provided."),void this.errorLog("expected obj[0].promos"))},OverlayManager.prototype.adFreeCheck=function(){this.adfree&&"true"!==this.promo.parameters.onAdfree||this.setSize()},OverlayManager.prototype.overlayCheck=function(){var a,b,c,d,e=this.options[0].promos,f=e.length;for(a=0;f>a;a++){if(c=!0,e[a].parameters&&e[a].parameters.includes){if(d=this.checkIncludes(e[a].parameters.includes.split(","))){b=a;break}}else b=a;e[a].parameters&&e[a].parameters.excludes&&!d?(c=this.checkExcludes(e[a].parameters.excludes.split(",")),c&&(b=a)):b=a}c&&(this.promo=this.options[0].promos[b],this.adFreeCheck())},OverlayManager.prototype.checkExcludes=function(a){var b,c=a.length,d=this.options.currentUrl,e=!0;for(b=0;c>b;b++)if(d.match(a[b])){e=!1;break}return e},OverlayManager.prototype.checkIncludes=function(a){var b,c=this.options.currentUrl,d=!1,e=a.length;for(b=0;e>b;b++)if(c.match(a[b])){d=!0;break}return d},OverlayManager.prototype.setSize=function(){var a=this.promo.parameters.width||this.options.width,b=this.promo.parameters.height||this.options.height;this.frame={width:parseInt(a,10),height:parseInt(b,10),units:a.replace(parseInt(a,10),""),image:"true"===this.promo.parameters.imageOnly?!0:!1,path:this.promo.customIncludeUrl?this.promo.customIncludeUrl:null,link:this.promo.parameters.imageLink?this.promo.parameters.imageLink:null},this.frame.path&&this.buildPromo()},OverlayManager.prototype.buildPromo=function(){"true"===this.promo.parameters.deferCookie?(console.log("defer cookie"),this.createMask()):this.cookieStatus()},OverlayManager.prototype.cookieStatus=function(){this.checkCookie()||this.setCookie()},OverlayManager.prototype.checkCookie=function(){var a,b=document.cookie.split(";"),c=b.length;for(a=0;c>a;a++)if(""!==b[a]&&b[a].indexOf(this.options.cookieName)>-1)return!0;return!1},OverlayManager.prototype.setCookie=function(){var a,b,c=this.promo.parameters,d=new Date;this.options.cookieName=c.cookieName?c.cookieName:this.options.cookieName,this.options.cookieValue=c.cookieValue?c.cookieValue:this.options.cookieValue,this.options.cookieTime=c.cookieTime?c.cookieTime:this.options.cookieTime,d.setTime(d.getTime()+24*this.options.cookieTime*60*60*1e3),a="expires="+d.toUTCString(),b=this.options.cookieName+"="+this.options.cookieValue+";"+a+";path=/",(document.cookie=b)&&this.createMask()},OverlayManager.prototype.createMask=function(){var a=document.createElement("div");a.id=this.OVERLAY_ID,a.className="overlayMask",a.style.position="fixed",a.style.backgroundColor="rgba("+this.options.backgroundColor+", "+this.options.opacity+")",a.style.border="none",a.style.width="100%",a.style.height="100%",a.style.top="0",a.style.left="0",a.style.zIndex=2147483654,this.setupListeners()&&this.$body.append(a)&&this.createFrame()},OverlayManager.prototype.createFrame=function(){var a=this.frame.image?document.createElement("img"):document.createElement("iframe"),b=this.frame;a.id=this.FRAME_ID,a.style.position="fixed",a.style.backgroundColor="transparent",a.style.border="none",a.style.width=b.width+b.units,a.style.height=b.height+b.units,a.style.zIndex=10,a.allowTransparency="true",a.frameBorder=0,a.scrolling="no",a.src=b.path,"%"===b.units?(a.style.top=(100-b.height)/2+b.units,a.style.left=(100-b.width)/2+b.units):(a.style.top="50%",a.style.left="50%",a.style.marginLeft="-"+Math.floor(b.width/2)+b.units,a.style.marginTop="-"+Math.floor(b.height/2)+b.units),this.$body.find("#"+this.OVERLAY_ID).append(a)},OverlayManager.prototype.setupListeners=function(){var a=!0;return this.$body.hasClass("activeOverlay")&&(a=!1),this.$body.toggleClass("activeOverlay",!0),this.$window.bind("overlay.kill",$.proxy(this.remove,this)),a},OverlayManager.prototype.remove=function(){this.$body.hasClass("activeOverlay")&&(this.$body.toggleClass("activeOverlay",!1).find("#"+this.OVERLAY_ID).remove(),this.$window.unbind("overlay.kill"))},OverlayManager.prototype.errorLog=function(a){console.error("OverlayManager -> "+a)};