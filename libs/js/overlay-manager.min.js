"use strict";var OverlayManager=function(a,b){return a&&"object"==typeof a?(this.zones=a[0].promos,this.adfree=b||!1,this.$window=$(window),this.$body=$("body"),void this.batting()):(this.logging("Data object has not been provided","error"),!1)};OverlayManager.prototype.FRAME_ID="OverlayFrame",OverlayManager.prototype.OVERLAY_ID="OverlayModal",OverlayManager.prototype.adFreeCheck=function(){return this.adfree&&this.adfree!==this.options.onAdfree?!1:!0},OverlayManager.prototype.batting=function(){var a=this.overlayCheck();return"object"!=typeof a?(this.logging("no match provided","yarn"),!1):(this.setOptions(a),void(this.adFreeCheck()&&this.cookieStatus()&&(this.createMask(),this.setupListeners())))},OverlayManager.prototype.checkContents=function(){var a=this.options.customIncludeUrl;return null!==a.match(/.(gif|jpg|png)$/)},OverlayManager.prototype.checkCookie=function(a){if(!a)return!1;var b,c=document.cookie.split(";"),d=c.length;for(b=0;d>b;b++)if(""!==c[b]&&c[b].indexOf(a)>-1)return!0;return!1},OverlayManager.prototype.checkDevice=function(a){var b,c=a.length;for(b=0;c>b;b++){if(this.checkCookie(a[b]))return this.logging("Device cookie match","warn"),!0;if(this.deviceSize(a[b]))return this.logging("Device size match","warn"),!0}return!1},OverlayManager.prototype.createFrame=function(){var a=this.checkContents(),b=parseInt(this.options.height,10),c=this.options.height.replace(b,""),d=a?document.createElement("img"):document.createElement("iframe");d.id=this.FRAME_ID,d.style.width=this.options.width,d.style.height=this.options.height,d.style.backgroundColor="transparent",d.style.position="relative",d.style.border="none",d.style.zIndex=10,d.style.verticalAlign="center",d.allowTransparency="true",d.frameBorder=0,d.scrolling="no",d.src=this.options.customIncludeUrl,"%"===c?d.style.top=(100-b)/2+c:(d.style.top="50%",d.style.marginTop="-"+Math.floor(b/2)+c),a&&this.options.link?this.$body.find("#"+this.OVERLAY_ID).append($("<a>").attr("href",this.options.link).append(d)).show():this.$body.find("#"+this.OVERLAY_ID).append(d).show()},OverlayManager.prototype.cookieStatus=function(){return this.options.deferCookie?(this.logging(this.options.cookieName+" cookie has been defered","warn"),!0):this.checkCookie(this.options.cookieName)?void this.logging(this.options.cookieName+"cookie has already been set","warn"):this.setCookie()},OverlayManager.prototype.createClose=function(){var a={width:"35px",height:"35px",color:"white",border:"2px solid white",background:"black","border-radius":"25px","text-decoration":"none",display:"block",font:"30px/1 Arial","font-weight":"Bold",position:"absolute",right:"1%",top:"2%",zIndex:"99999"};this.$body.find("#"+this.OVERLAY_ID).append($("<a>").attr("href","#").text("x").css(a).bind("click",$.proxy(this.relaunchToggle,this)))},OverlayManager.prototype.createMask=function(){var a=document.createElement("div");a.id=this.OVERLAY_ID,a.className="overlayMask",a.style.position="fixed",a.style.backgroundColor="rgba("+this.options.backgroundColor+", "+this.options.opacity+")",a.style.border="none",a.style.width="100%",a.style.height="100%",a.style.top="0",a.style.left="0",a.style.textAlign="center",a.style.zIndex=2147483654,a.style.display="none",this.$body.append(a)&&(this.options.showClose&&this.createClose(),this.createFrame(),this.options.relaunch&&this.createRelaunch())},OverlayManager.prototype.createRelaunch=function(){var a={width:"135px",padding:"10px 0",color:"white",border:"2px solid white",background:"black","border-radius":"5px","text-decoration":"none",display:"none",font:"30px/1 Arial","font-weight":"Bold",position:"absolute",left:"1%",bottom:"2%",zIndex:"99999","text-align":"center"};this.$body.append($("<a>").attr({id:"relaunchOverlay",href:"#"}).addClass("relaunchOverlay").text("relaunch").css(a).bind("click",$.proxy(this.relaunchToggle,this)))},OverlayManager.prototype.defaults={cookieTime:1,cookieValue:"true",cookieName:"OverlayCookie",width:"100%",height:"100%",backgroundColor:"0,0,0",opacity:"0.8",onAdfree:!1,deferCookie:!1,showClose:!1,currentUrl:window.location.href,relaunch:!1},OverlayManager.prototype.deviceSize=function(a){var b,c,d="desktop",e=this.$body.width();return window.matchMedia("(orientation: landscape)").matches?(b=1024,c=668):(b=768,c=375),c>=e?d="mobile":b>=e&&(d="tablet"),a===d?!0:!1},OverlayManager.prototype.logging=function(a,b){return console?void("object"!=typeof a?"error"===b?console.error("OverlayManager -> "+a):"warn"===b?console.warn("OverlayManager -> "+a):console.log("OverlayManager -> "+a):"error"===b?console.error("OverlayManager Obj-> ",a):"warn"===b?console.warn("OverlayManager Obj-> ",a):console.log("OverlayManager Obj-> ",a)):!1},OverlayManager.prototype.matchCheck=function(a){var b,c,d;if(!a)return!1;for(c=a.length,d=this.defaults.currentUrl,b=0;c>b;b++)if(d.match(a[b]))return!0;return!1},OverlayManager.prototype.overlayCheck=function(){var a,b,c,d=this.zones,e=d.length;for(a=0;e>a;a++)if(d[a].parameters){if(c=d[a].parameters,!c.device||this.checkDevice(c.device.split(",")))if(c.includes){if(this.matchCheck(c.includes.split(","))){b=a;break}}else c.excludes&&this.matchCheck(c.excludes.split(","))||(b=a)}else b=a;return void 0!==b?(this.logging("Matching page overlay","warn"),d[b]):!1},OverlayManager.prototype.relaunchToggle=function(){this.options.relaunch?this.relaunch():this.remove()},OverlayManager.prototype.relaunch=function(){this.$body.hasClass("activeOverlay")&&(this.$body.find("#relaunchOverlay").toggle(),this.$body.find("#"+this.OVERLAY_ID).toggle())},OverlayManager.prototype.remove=function(){this.$body.hasClass("activeOverlay")&&(this.$body.toggleClass("activeOverlay",!1).find("#"+this.OVERLAY_ID).remove(),this.$window.unbind("overlay.kill"),this.$window.unbind("overlay.relaunch"),this.logging("Closing overlay","warn"))},OverlayManager.prototype.runLoop=function(a,b){return a.forEach(function(a){return b===a?!0:void 0}),!1},OverlayManager.prototype.setCookie=function(){var a,b,c=new Date;return c.setTime(c.getTime()+24*this.options.cookieTime*60*60*1e3),a="expires="+c.toUTCString(),b=this.options.cookieName+"="+this.options.cookieValue+";"+a+";path=/",(document.cookie=b)?!0:!1},OverlayManager.prototype.setOptions=function(a){return a?(a.parameters?(this.options=$.extend(this.options,this.defaults,a.parameters),this.options.customIncludeUrl=a.customIncludeUrl):this.options=$.extend(this.options,this.defaults,a),void this.logging(this.options,"warn")):(this.logging("No data options provided","error"),!1)},OverlayManager.prototype.setupListeners=function(){var a=!0;return this.$body.hasClass("activeOverlay")&&(a=!1),this.$body.toggleClass("activeOverlay",!0),this.$window.bind("overlay.kill",$.proxy(this.remove,this)),a};